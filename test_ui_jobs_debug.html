<!DOCTYPE html>
<html>
<head>
    <title>üêõ UI Jobs Debug - Football Value Betting</title>
    <meta charset="utf-8">
    <style>
        body {
            margin: 0;
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            color: #f0fdf4;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            min-height: 100vh;
            padding: 32px;
        }
        .test-container {
            max-width: 1000px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            margin-bottom: 32px;
            background: rgba(6,95,70,0.8);
            border: 2px solid #10b981;
            border-radius: 16px;
            padding: 24px;
        }
        .test-card {
            background: rgba(6,95,70,0.6);
            border: 1px solid #10b981;
            border-radius: 12px;
            padding: 24px;
            margin: 16px 0;
        }
        .test-btn {
            background: linear-gradient(145deg, #10b981, #059669);
            border: 2px solid #34d399;
            color: #ffffff;
            padding: 12px 24px;
            border-radius: 8px;
            margin: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .test-btn:hover {
            background: linear-gradient(145deg, #059669, #047857);
            transform: translateY(-2px);
        }
        .result {
            background: rgba(4,120,87,0.6);
            border: 1px solid rgba(16,185,129,0.5);
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            max-height: 300px;
            overflow-y: auto;
        }
        .status-success {
            color: #86efac;
            font-weight: 600;
        }
        .status-error {
            color: #fca5a5;
            font-weight: 600;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="header">
            <h1>üêõ UI Jobs & History Debug</h1>
            <p>–¢–µ—Å—Ç–∏—Ä—É–µ–º UI —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö</p>
        </div>

        <div class="test-card">
            <h3>üìä API Endpoints Test</h3>
            <button class="test-btn" onclick="testPicksAPI()">Test /api/v1/picks</button>
            <button class="test-btn" onclick="testJobsAPI()">Test /api/v1/jobs/runs</button>
            <button class="test-btn" onclick="testJobStatusAPI()">Test /api/v1/jobs/status</button>
            <div id="api-results" class="result"></div>
        </div>

        <div class="test-card">
            <h3>‚öôÔ∏è Jobs Control Test</h3>
            <button class="test-btn" onclick="testSyncJob()">Test Sync Data Job</button>
            <button class="test-btn" onclick="testBuildPredictions()">Test Build Predictions</button>
            <div id="job-results" class="result"></div>
        </div>

        <div class="test-card">
            <h3>üß™ UI Functions Test</h3>
            <button class="test-btn" onclick="testUIElements()">Test UI Element IDs</button>
            <button class="test-btn" onclick="testConsoleErrors()">Check Console Errors</button>
            <div id="ui-results" class="result"></div>
        </div>

        <div class="test-card">
            <h3>üéØ Live UI Debug</h3>
            <button class="test-btn" onclick="openMainApp()">Open Main App</button>
            <button class="test-btn" onclick="testMainAppFunctions()">Test Main App Functions</button>
            <div id="live-results" class="result"></div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000';
        const HEADERS = { 'X-Admin-Token': 'dev' };

        async function testPicksAPI() {
            const resultsDiv = document.getElementById('api-results');
            resultsDiv.innerHTML = 'Testing /api/v1/picks...';

            try {
                const response = await fetch(`${API_BASE}/api/v1/picks?limit=5`, { headers: HEADERS });
                const data = await response.json();

                resultsDiv.innerHTML = `<div class="status-success">‚úÖ /api/v1/picks SUCCESS</div>
Response: ${response.status}
Count: ${data.length} picks
Sample: ${JSON.stringify(data[0], null, 2)}`;
            } catch (error) {
                resultsDiv.innerHTML = `<div class="status-error">‚ùå /api/v1/picks ERROR</div>
${error.message}`;
            }
        }

        async function testJobsAPI() {
            const resultsDiv = document.getElementById('api-results');
            resultsDiv.innerHTML = 'Testing /api/v1/jobs/runs...';

            try {
                const response = await fetch(`${API_BASE}/api/v1/jobs/runs?limit=5`, { headers: HEADERS });
                const data = await response.json();

                resultsDiv.innerHTML = `<div class="status-success">‚úÖ /api/v1/jobs/runs SUCCESS</div>
Response: ${response.status}
Count: ${data.length} jobs
Sample: ${JSON.stringify(data[0], null, 2)}`;
            } catch (error) {
                resultsDiv.innerHTML = `<div class="status-error">‚ùå /api/v1/jobs/runs ERROR</div>
${error.message}`;
            }
        }

        async function testJobStatusAPI() {
            const resultsDiv = document.getElementById('api-results');
            resultsDiv.innerHTML = 'Testing /api/v1/jobs/status...';

            try {
                const response = await fetch(`${API_BASE}/api/v1/jobs/status`, { headers: HEADERS });
                const data = await response.json();

                resultsDiv.innerHTML = `<div class="status-success">‚úÖ /api/v1/jobs/status SUCCESS</div>
Response: ${response.status}
Data: ${JSON.stringify(data, null, 2)}`;
            } catch (error) {
                resultsDiv.innerHTML = `<div class="status-error">‚ùå /api/v1/jobs/status ERROR</div>
${error.message}`;
            }
        }

        async function testSyncJob() {
            const resultsDiv = document.getElementById('job-results');
            resultsDiv.innerHTML = 'Testing sync_data job execution...';

            try {
                const response = await fetch(`${API_BASE}/api/v1/run-now?job=sync_data`, {
                    method: 'POST',
                    headers: HEADERS
                });
                const data = await response.json();

                resultsDiv.innerHTML = `<div class="status-success">‚úÖ sync_data JOB SUCCESS</div>
Response: ${response.status}
Result: ${JSON.stringify(data, null, 2)}`;
            } catch (error) {
                resultsDiv.innerHTML = `<div class="status-error">‚ùå sync_data JOB ERROR</div>
${error.message}`;
            }
        }

        async function testBuildPredictions() {
            const resultsDiv = document.getElementById('job-results');
            resultsDiv.innerHTML = 'Testing build_predictions job execution...';

            try {
                const response = await fetch(`${API_BASE}/api/v1/run-now?job=build_predictions`, {
                    method: 'POST',
                    headers: HEADERS
                });
                const data = await response.json();

                resultsDiv.innerHTML = `<div class="status-success">‚úÖ build_predictions JOB SUCCESS</div>
Response: ${response.status}
Result: ${JSON.stringify(data, null, 2)}`;
            } catch (error) {
                resultsDiv.innerHTML = `<div class="status-error">‚ùå build_predictions JOB ERROR</div>
${error.message}`;
            }
        }

        async function testUIElements() {
            const resultsDiv = document.getElementById('ui-results');

            // –ü—Ä–æ–≤–µ—Ä–∏–º –æ—Å–Ω–æ–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ main app
            const elements = [
                'jobs-content',
                'predictions-history-container',
                'job-execution-log'
            ];

            let results = '';

            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –Ω–æ–≤–æ–µ –æ–∫–Ω–æ —Å main app –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
            const appWindow = window.open('http://localhost:8000', '_blank');

            setTimeout(() => {
                elements.forEach(id => {
                    const element = appWindow.document.getElementById(id);
                    results += `${id}: ${element ? '‚úÖ Found' : '‚ùå Not Found'}\n`;
                });

                resultsDiv.innerHTML = results;
            }, 3000);
        }

        function testConsoleErrors() {
            const resultsDiv = document.getElementById('ui-results');
            resultsDiv.innerHTML = `To check console errors:
1. Open browser DevTools (F12)
2. Go to Console tab
3. Navigate to http://localhost:8000
4. Login with 'dev' token
5. Go to Jobs & Tasks section
6. Look for any JavaScript errors in console`;
        }

        function openMainApp() {
            window.open('http://localhost:8000', '_blank');
            document.getElementById('live-results').innerHTML = 'üöÄ Main app opened in new tab. Check Jobs & Tasks section!';
        }

        function testMainAppFunctions() {
            const resultsDiv = document.getElementById('live-results');
            resultsDiv.innerHTML = `Manual testing checklist:

1. ‚úÖ Open http://localhost:8000
2. ‚úÖ Login with token 'dev'
3. ‚úÖ Click "Jobs & Tasks" in navigation
4. ‚ùì Check if prediction history table is visible
5. ‚ùì Try clicking a job button (e.g., "Sync Data")
6. ‚ùì Check if job execution log appears
7. ‚ùì Check browser console for JavaScript errors

Expected results:
- Jobs should execute successfully
- Prediction history should show data table
- No console errors should appear`;
        }

        // Auto-test on load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üêõ Debug page loaded');
            setTimeout(testPicksAPI, 1000);
        });
    </script>
</body>
</html>